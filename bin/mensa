#!/usr/bin/python3
import argparse

from mensa import logic
from mensa import base

parser = argparse.ArgumentParser(description='Fetch menus from various sources')
# parser.add_argument('integers', metavar='N', type=int, nargs='+',
#                     help='an integer for the accumulator')
parser.add_argument('-r', '--restaurants',  dest='rest', action='store',
                    metavar='LIST',
                    help='Comma-separated list of restaurants to fetch the menus from.')
parser.add_argument('-l', '--list-restaurants',  dest='list', action='store_true',
                    help='get list of restaurants')


args = parser.parse_args()
## Load backends
logic.init_foodsources()
## Load frontends (not yet implemented)
logic.init_renderers()



if args.list :
    for k,i in base.foodsources.items():
        print(i.name, i.human_name)
    exit()
restlist = None
if args.rest :
    restlist = args.rest.split(",")

foodl = logic.get_food(restlist)
logic.render(foodl, ["plain-text"])
